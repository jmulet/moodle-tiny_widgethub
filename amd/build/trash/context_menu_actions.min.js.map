{"version":3,"file":"context_menu_actions.min.js","sources":["../../src/trash/context_menu_actions.js"],"sourcesContent":["/* eslint-disable no-eq-null */\n/* eslint-disable no-console */\nimport jQuery from 'jquery';\nimport {getUserId} from './options';\nimport {convertInt} from './util';\nimport ContextMenuEditor from './context_menu_editor';\nimport {displayFilepicker} from 'editor_tiny/utils';\n\n/**\n * Move jquery element before its sibling (if possible)\n * @param {JQuery<Element>} $e\n */\nfunction moveBefore($e) {\n    const prev = $e.prev();\n    if (!prev.length) {\n        return;\n    }\n    $e.insertBefore(prev);\n}\n\n/**\n * Move jquery element after its sibling (if possible)\n * @param {JQuery<Element>} $e\n */\nexport function moveAfter($e) {\n    const next = $e.next();\n    if (!next.length) {\n        return;\n    }\n    $e.insertAfter(next);\n}\n\n\nexport default {\n    \"@edit\": function(evt) {\n        const ctxDlgEditor = new ContextMenuEditor(this);\n        ctxDlgEditor.show(evt);\n    },\n    \"@unpack\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        if (this.currentContext.snpt.unpack === \"\") {\n            // Simply remove classes and done!\n            $target.removeClass();\n        } else {\n            // Problem with .row-fluid.iedib-fluid\n            const toUnpack = $target.find(this.currentContext.snpt.unpack + \"\");\n            toUnpack.first().removeClass(\"iedib-inspoint iedib-iq\");\n            $target.replaceWith(toUnpack);\n        }\n        this.uiContextMenu.hide();\n    },\n    \"@clipboard/cut\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        const $parent = $target.parent();\n        // Some widgets have footer as sibling so it is not contained in target\n        const $sibling = $target.next();\n        let siblingHTML = '';\n        if ($sibling.find('.iedib-caption-title').length) {\n            $sibling.css('text-align', 'center');\n            siblingHTML = ' ' + $sibling.prop(\"outerHTML\");\n            console.log(\"Adding sibling HTML \", siblingHTML);\n            $sibling.detach();\n        }\n        $target.detach();\n        // If the parent has no children, then it can be safely removed\n        if ($parent.children().length === 0) {\n            $parent.remove();\n        }\n        const content = this.currentContext.snpt.name + \" @@ \" + $target.prop(\"outerHTML\") + siblingHTML;\n        try {\n            this.clipBoard.push(content);\n            const userid = getUserId(this.editor);\n            localStorage.setItem(\"widgethub-clipboard_\" + userid, JSON.stringify(this.clipBoard));\n        } catch (ex) {\n            console.error(ex);\n        }\n        this.uiContextMenu.hide();\n    },\n    \"@clipboard/paste\": function(evt) {\n        evt.preventDefault();\n        this.uiContextMenu.hide();\n        const indx = convertInt(evt.currentTarget.dataset.indx, 0);\n        // Prevent from pasting outsite tiny editor\n        const clipBoardQueue = this.clipBoard;\n        if (clipBoardQueue.length > 0 && indx < clipBoardQueue.length) {\n            const toPaste = this.clipBoard[indx].replace(/^.*@@/, \"\");\n            this.editor.selection.setContent(toPaste);\n            try {\n                clipBoardQueue.splice(indx, 1); // Remove that item pasted\n                const userid = getUserId(this.editor);\n                localStorage.setItem(\"widgethub-clipboard_\" + userid, JSON.stringify(this.clipBoard));\n            } catch (ex) {\n                console.error(ex);\n            }\n        }\n    },\n    \"@clipboard/clear\": function(evt) {\n        evt.preventDefault();\n        this.uiContextMenu.hide();\n        try {\n            const userid = getUserId(this.editor);\n            this.clipBoard = [];\n            localStorage.setItem(\"widgethub-clipboard_\" + userid, \"[]\");\n        } catch (ex) {\n            console.error(ex);\n        }\n    },\n    \"tabs/add\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        // Clone the last item and add it\n        const $allLI = $target.find(\"ul.nav.nav-tabs > li\");\n        const $lst = $allLI.last().clone();\n        const href = $lst.find(\"a\").attr(\"href\") || \"\";\n        const $panel = $target.find(href).clone();\n        const newId = 'ed' + Math.random().toString(32).substring(2);\n        $panel.html('<p>Edita el contingut ' + newId + '.</p>');\n        $panel.attr('id', newId);\n        $panel.removeClass(\"active\");\n        const theA = $lst.find(\"a\");\n        theA.attr(\"href\", \"#\" + newId);\n        theA.removeClass(\"active\");\n        theA.html('<span>&nbsp;Tab' + ($allLI.length + 1) + '</span>');\n\n        // Decide where to place the new Tab\n        if (!this.currentContext.theTab) {\n            // Append to the end\n            $target.find(\"ul.nav.nav-tabs\").append($lst);\n            $target.find(\"div.tab-content\").append($panel);\n        } else {\n            const $theTab = jQuery(this.currentContext.theTab);\n            const referencePanel = $target.find($theTab.attr(\"href\") || \"\");\n            if (evt.currentTarget.dataset.before) {\n                $lst.insertBefore($theTab.parent());\n                $panel.insertBefore(referencePanel);\n            } else {\n                $lst.insertAfter($theTab.parent());\n                $panel.insertAfter(referencePanel);\n            }\n        }\n        this.uiContextMenu.hide();\n    },\n    \"tabs/move\": function(evt) {\n        evt.preventDefault();\n        if (this.currentContext.theTab == null) {\n            this.uiContextMenu.hide();\n            return;\n        }\n        const $target = jQuery(this.currentContext.elem);\n        const href = this.currentContext.theTab.getAttribute(\"href\") || \"\";\n        const $panel = $target.find(href);\n        const $li = jQuery(this.currentContext.theTab).parent();\n\n        // Decide where to move the new Tab\n        if (evt.currentTarget.dataset.before) {\n            // Move before the current\n            moveBefore($li);\n            moveBefore($panel);\n        } else {\n            // Move after the current\n            moveAfter($li);\n            moveAfter($panel);\n        }\n        this.uiContextMenu.hide();\n    },\n    \"tabs/del\": function(evt) {\n        evt.preventDefault();\n        if (this.currentContext.theTab == null) {\n            this.uiContextMenu.hide();\n            return;\n        }\n        const $target = jQuery(this.currentContext.elem);\n        const tabs = $target.find(\"ul.nav.nav-tabs > li\");\n        if (tabs.length === 1) {\n            // If only one tab --> remove the entire menu instead\n            $target.remove();\n        } else {\n            // Remove the tab selected\n            const href = this.currentContext.theTab.getAttribute(\"href\") || \"\";\n            $target.find(href).remove();\n            const theLi = this.currentContext.theTab.parentElement;\n            if (theLi) {\n                jQuery(theLi).remove();\n            }\n            // Must make at least one tab active\n            $target.find(\"ul.nav.nav-tabs > li > a\").first().trigger(\"click\");\n        }\n        this.uiContextMenu.hide();\n    },\n    \"imatge\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        const which = evt.currentTarget.dataset.effect;\n        if (!which) {\n            $target.removeAttr(\"data-snptd\");\n        } else {\n            $target.attr(\"data-snptd\", which);\n        }\n        this.uiContextMenu.hide();\n    },\n    \"imatge-fons\": function(evt) {\n        evt.preventDefault();\n        this.uiContextMenu.hide();\n        const $target = jQuery(this.currentContext.elem);\n        displayFilepicker(this.editor, 'image').then((params) => {\n            if (params?.url) {\n                $target.css(\"background-image\", \"url('\" + params.url + \"')\");\n            }\n            return;\n        }).catch();\n    },\n    \"two-cols\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        if (evt.currentTarget.dataset.cols === \"rm\") {\n            // To one column\n            const columns = $target.find(\"div\");\n            columns.removeClass();\n            $target.replaceWith(columns);\n        } else {\n            // Define the spans\n            const colSpan = convertInt(evt.currentTarget.dataset.cols, 0);\n            const first = $target.find(\"div:first-child\");\n            const last = $target.find(\"div:last-child\");\n            first.removeClass();\n            last.removeClass();\n            first.addClass(\"span\" + colSpan);\n            last.addClass(\"span\" + (12 - colSpan));\n        }\n        this.uiContextMenu.hide();\n    },\n    \"desplegable2\": function(evt) {\n        evt.preventDefault();\n        if (this.currentContext.theTab == null) {\n            console.error(\"theTab is null\");\n            this.uiContextMenu.hide();\n            return;\n        }\n        const $target = jQuery(this.currentContext.elem);\n        const $group = jQuery(this.currentContext.theTab);\n        const opt = evt.currentTarget.dataset.accordion;\n        if (opt === \"rm\") {\n            // Remove the current tab\n            $group.remove();\n            if ($target.find(\"div.accordion-group\").length === 0) {\n                // Remove everything\n                $target.remove();\n            }\n        } else if (opt === \"iup\") {\n            // Insert one up\n            const $cloneGroup = $target.find(\"div.accordion-group:first-child\").clone();\n            const newId = \"nid_\" + Math.random().toString(32).substring(2);\n            $cloneGroup.find(\"a.accordion-toggle\").attr(\"href\", \"#\" + newId);\n            $cloneGroup.find(\"div.accordion-body\").attr(\"id\", newId);\n            $cloneGroup.find(\"div.accordion-body > .accordion-inner\").html(\"<p>Editar contingut</p>\");\n            $cloneGroup.insertBefore($group);\n        } else if (opt === \"idwn\") {\n            // Insert one down\n            const $cloneGroup2 = $target.find(\"div.accordion-group:first-child\").clone();\n            const newId2 = \"nid_\" + Math.random().toString(32).substring(2);\n            $cloneGroup2.find(\"a.accordion-toggle\").attr(\"href\", \"#\" + newId2);\n            $cloneGroup2.find(\"div.accordion-body\").attr(\"id\", newId2);\n            $cloneGroup2.find(\"div.accordion-body > .accordion-inner\").html(\"<p>Editar contingut</p>\");\n            $cloneGroup2.insertAfter($group);\n        } else if (opt === \"2list\") {\n            // Convert into a list\n            const listSubstitute = jQuery(\"<ul></ul>\");\n            $target.find(\"a.accordion-toggle\").each((i, a) => {\n                const $e = $target.find(a.getAttribute(\"href\") || \"\");\n                $e.detach();\n                $e.removeClass();\n                const theLi = jQuery(\"<li></li>\");\n                theLi.append(a.innerHTML);\n                theLi.append($e);\n                listSubstitute.append(theLi);\n            });\n            $target.replaceWith(listSubstitute);\n        } else if (opt === \"mup\") {\n            // Move up\n            moveBefore($group);\n        } else if (opt === \"mdwn\") {\n            // Move down\n            moveAfter($group);\n        } else if (opt === \"bind\") {\n            // Behavior individual\n            $target.find(\"div.accordion-body\").removeAttr(\"data-parent\");\n        } else if (opt === \"bacc\") {\n            // Behavior accordion\n            const acid = $target.attr(\"id\");\n            $target.find(\"div.accordion-body\").attr(\"data-parent\", \"#\" + acid);\n        }\n        this.uiContextMenu.hide();\n    },\n    \"taula-predefinida\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n\n        const act = evt.currentTarget.dataset.pos;\n        if (act === \"2bs\") {\n            $target.removeClass(\"iedib-table\");\n            $target.addClass(\"table table-striped iedib-bstable\");\n            $target.find(\"td,th\").removeAttr(\"style\");\n            $target.find(\"thead > tr > th\").attr(\"role\", \"col\");\n        } else if (act === \"2pf\") {\n            $target.removeClass(\"table table-bordered table-hover table-striped table-responsive iedib-bstable\");\n            $target.addClass(\"iedib-table\");\n            $target.attr(\"style\", 'table-layout:fixed; border-collapse:collapse; border-spacing:0px; width:96%;');\n            $target.find(\"td,th\").css(\"border\", '1px solid gray');\n        } else if (act === \"thead\") {\n            let head = $target.find(\"thead\");\n            if (head.length) {\n                head.remove();\n            } else {\n                head = jQuery(\"<thead></thead>\");\n                const tr = jQuery(\"<tr></tr>\");\n                $target.find(\"tr\").first().find(\"td\").each(function() {\n                    const newTh = jQuery('<th role=\"col\">Títol</th>');\n                    const st = jQuery(this).attr(\"style\");\n                    newTh.attr(\"style\", st ? st : \"\");\n                    tr.append(newTh);\n                });\n                head.append(tr);\n                $target.prepend(head);\n            }\n        } else if (act === \"tfoot\") {\n            let foot = $target.find(\"tfoot\");\n            if (foot.length) {\n                foot.remove();\n            } else {\n                foot = jQuery(\"<tfoot></tfoot>\");\n                const tr2 = jQuery(\"<tr></tr>\");\n                $target.find(\"tbody tr\").first().find(\"td\").each(function() {\n                    const newTd = jQuery(\"<td>Resum</td>\");\n                    const st = jQuery(this).attr(\"style\");\n                    newTd.attr(\"style\", st ? st : \"\");\n                    tr2.append(newTd);\n                });\n                foot.append(tr2);\n                $target.append(foot);\n            }\n        } else if (act === \"delres\") {\n            // Delete responsiveness\n            $target.parent().replaceWith($target);\n        } else if (act === \"addres\") {\n            // Add responsiveness\n            const $div = jQuery('<div class=\"table-responsive\"></div>');\n            $target.replaceWith($div);\n            $div.append(jQuery(this.currentContext.elem));\n        }\n        this.uiContextMenu.hide();\n    },\n    \"taula-predefinida/maxwidth\": function(evt) {\n        const $target = jQuery(this.currentContext.elem);\n        const maxwidth = convertInt(evt.currentTarget.dataset.value, 0);\n        if (maxwidth > 0) {\n            $target.css(\"max-width\", maxwidth + \"px\");\n        } else {\n            $target.css(\"max-width\", \"\");\n        }\n    },\n    \"capsa\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        let newLang = evt.currentTarget.dataset.lang || \"ca\";\n        const newType = evt.currentTarget.dataset.type;\n        const isTascaExercici = evt.currentTarget.dataset.proposat === 'true';\n        console.log(isTascaExercici, this.currentContext.elem);\n        let widgetKey = this.currentContext.snpt.key;\n        let $lateral;\n        if (newType) {\n            // Accions sobre canvi de tipus de capsa\n            $target.removeClass(\n            \"iedib-alerta-border iedib-important-border iedib-consell-border iedib-introduccio-border iedib-ampliacio-border\");\n            $target.addClass(\"iedib-\" + newType + \"-border\");\n            $lateral = $target.find(\".iedib-lateral\");\n            $lateral.removeClass(\"iedib-alerta iedib-important iedib-consell iedib-introduccio iedib-ampliacio\");\n            $lateral.addClass(\"iedib-\" + newType);\n            newLang = $target.attr(\"data-lang\") || \"ca\";\n        }\n        if (newLang) {\n            // Canvi el contingut de l'etiqueta\n            $lateral = $target.find(\"div.iedib-lateral > p.iedib-titolLateral\");\n            const theType = newType || evt.currentTarget.dataset.oldtype;\n            $target.attr(\"data-lang\", newLang);\n            if (isTascaExercici) {\n                widgetKey = 'tasca-exercici';\n            }\n            const widget = this.currentContext.snpt;\n            if (widget != null) {\n                const I18n = widget.I18n;\n                let langKey = widgetKey === \"capsa-generica\" ? \"msg_\" + theType : \"msg\";\n                if (isTascaExercici) {\n                    langKey = 'msg_epr';\n                }\n                if (I18n && I18n[langKey] && I18n[langKey][newLang]) {\n                    if (isTascaExercici) {\n                        const h4 = $target.find('.iedib-central h4').first();\n                        h4.html(I18n[langKey][newLang]);\n                    } else {\n                        $lateral.html(I18n[langKey][newLang]);\n                        $lateral.append('<span class=\"iedib-' + theType + '-logo\"></span>');\n                    }\n                }\n            }\n        }\n        this.uiContextMenu.hide();\n    },\n    \"capsa/mida\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        $target.removeClass(\"iedib-capsa-petita iedib-capsa-mitjana iedib-capsa-gran\");\n        $target.addClass(\"iedib-capsa-\" + evt.currentTarget.dataset.mida);\n        this.uiContextMenu.hide();\n    },\n    \"capsa-exemple-cols\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        const lang = $target.attr(\"data-lang\") || \"ca\";\n        const lateral = $target.find(\"p.iedib-titolLateral\").html();\n        const formulacio = $target.find(\"div.span4.iedib-formulacio > *\");\n        const resolucio = $target.find(\"div.span8.iedib-resolucio > div.iedib-central > *\");\n        const newSnpt = jQuery('<div class=\"iedib-capsa iedib-capsa-gran iedib-exemple-border\" data-lang=\"' + lang + '\">' +\n            '<div class=\"iedib-lateral iedib-exemple\">' +\n            '<p class=\"iedib-titolLateral\">' + lateral + '</p>' +\n            '</div>' +\n            '<div class=\"iedib-formulacio-rows\">' +\n            // Add formulació\n            '</div>' +\n            '<div class=\"iedib-resolucio-rows\">' +\n            // Add resolució\n            '</div></div>');\n\n        newSnpt.find('div.iedib-formulacio-rows').append(formulacio);\n        newSnpt.find('div.iedib-resolucio-rows').append(resolucio);\n        $target.replaceWith(newSnpt);\n        this.uiContextMenu.hide();\n    },\n    \"capsa-exemple-rows\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        const lang = $target.attr(\"data-lang\") || \"ca\";\n        const solLabel = (this.currentContext.snpt.I18n?.sol || {})[lang] || 'Solució';\n        const formulacio = $target.find(\"div.iedib-formulacio-rows > *\").clone();\n        const resolucio = $target.find(\"div.iedib-resolucio-rows >  *\").clone();\n        const lateral = $target.find(\"p.iedib-titolLateral\").html();\n        const newSnpt = jQuery('<div class=\"iedib-capsa iedib-capsa-gran iedib-exemple-border\" data-lang=\"' + lang + '\">' +\n            '<div class=\"iedib-lateral iedib-exemple\">' +\n            '<p class=\"iedib-titolLateral\">' + lateral + '</span></p>' +\n            '</div>' +\n            '<div class=\"iedib-central\">' +\n            // Formulacio\n            // Resolució\n            '<br></div></div>');\n        console.log(resolucio);\n        const central = newSnpt.find('div.iedib-central');\n        central.append(formulacio);\n        if (resolucio.find('div.accordion').length === 0) {\n            central.append(\"<p><b>\" + solLabel + \"</b>:</p>\");\n        }\n        central.append(resolucio);\n        $target.replaceWith(newSnpt);\n        this.uiContextMenu.hide();\n    },\n    \"!ol\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        const opt = evt.currentTarget.dataset.ol;\n        if (opt === \"snorm\") {\n            // To norm style\n            $target.removeClass(\"iedib-falist\");\n            this.uiContextMenu.hide();\n        } else if (opt === \"sfa\") {\n            // To awesome style\n            $target.addClass(\"iedib-falist\");\n            // Make sure that start and style are in sync\n            const startAt = $target.attr(\"start\") || \"1\";\n            if (startAt != null) {\n                const beginAt = parseInt(startAt);\n                $target.css(\"counter-reset\", \"iedibfalist-counter \" + (beginAt - 1));\n            } else {\n                $target.css(\"counter-reset\", \"\");\n            }\n            this.uiContextMenu.hide();\n        } else if (opt === \"startAt\") {\n            // Change the number at which start\n            const startAt2 = evt.currentTarget.dataset.value || \"1\";\n            if (startAt2) {\n                const beginAt3 = parseInt(startAt2);\n                $target.attr(\"start\", beginAt3);\n                $target.css(\"counter-reset\", \"iedibfalist-counter \" + (beginAt3 - 1));\n            }\n        }\n    },\n    \"!img\": function(evt) {\n        evt.preventDefault();\n        const $target = jQuery(this.currentContext.elem);\n        const $snpt = jQuery('<div class=\"iedib-figura iedib-grid-responsive\"></div');\n        $snpt.append($target.clone());\n        // eslint-disable-next-line max-len\n        $snpt.append(jQuery('<p class=\"iedib-img-footer\"><span class=\"iedib-caption-counter\">Imatge:</span> <span class=\"iedib-caption-title\">Descripció</span></p>'));\n        $target.replaceWith($snpt);\n        this.uiContextMenu.hide();\n    }\n};"],"names":["moveBefore","$e","prev","length","insertBefore","moveAfter","next","insertAfter","evt","ContextMenuEditor","this","show","preventDefault","$target","currentContext","elem","snpt","unpack","removeClass","toUnpack","find","first","replaceWith","uiContextMenu","hide","$parent","parent","$sibling","siblingHTML","css","prop","console","log","detach","children","remove","content","name","clipBoard","push","userid","editor","localStorage","setItem","JSON","stringify","ex","error","indx","currentTarget","dataset","clipBoardQueue","toPaste","replace","selection","setContent","splice","$allLI","$lst","last","clone","href","attr","$panel","newId","Math","random","toString","substring","html","theA","theTab","$theTab","referencePanel","before","append","getAttribute","$li","theLi","parentElement","trigger","which","effect","removeAttr","then","params","url","catch","cols","columns","colSpan","addClass","$group","opt","accordion","$cloneGroup","$cloneGroup2","newId2","listSubstitute","each","i","a","innerHTML","acid","act","pos","head","tr","newTh","st","prepend","foot","tr2","newTd","$div","maxwidth","value","newLang","lang","newType","type","isTascaExercici","proposat","$lateral","widgetKey","key","theType","oldtype","widget","I18n","langKey","mida","lateral","formulacio","resolucio","newSnpt","solLabel","sol","central","ol","startAt","beginAt","parseInt","startAt2","beginAt3","$snpt"],"mappings":"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"}