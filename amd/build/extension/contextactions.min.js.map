{"version":3,"file":"contextactions.min.js","sources":["../../src/extension/contextactions.js"],"sourcesContent":["/* eslint-disable max-len */\n\nimport {registerMenuItem} from \"../extension\";\nimport {addRequires, cleanUnusedRequires} from \"./dependencies\";\n\n/**\n * @param {string} str\n * @returns {string}\n */\nfunction prefixPluginName(str) {\n    return str.split(/\\s+/).map(e => {\n        e = e.trim();\n        if (e === '|') {\n            return e;\n        }\n        return 'widgethub_' + e;\n    }).join(' ');\n}\n\n/**\n * @typedef {{name: string, title: string, widgetKey?: string, icon?:string, action?: ()=> void, subMenuItems?: () => string}} UserDefinedItem\n */\n\n/**\n * @param {import(\"../contextInit\").ItemMenuContext} ctx\n * @param {string} type\n * @returns {UserDefinedItem}\n */\nconst addImageEffectItem = (ctx, type) => {\n    return {\n        name: `add${type}Effect`,\n        title: `Afegir efecte ${type}`,\n        action: () => {\n            const elem = ctx.path?.elem;\n            if (!elem) {\n                return;\n            }\n            elem.attr(\"data-snptd\", type);\n            addRequires(ctx.editor, [\"/sd/images.min.js\"]);\n        }\n    };\n};\n\n/**\n * @param {import(\"../contextInit\").ItemMenuContext} ctx\n * @returns {UserDefinedItem}\n */\nconst removeImageEffectsItem = (ctx) => {\n    return {\n        name: 'removeImageEffects',\n        title: 'Eliminar efectes d\\'imatge',\n        icon: 'trash',\n        action: () => {\n            const elem = ctx.path?.elem;\n            if (!elem) {\n                return;\n            }\n            elem.removeAttr(\"data-snptd\");\n            cleanUnusedRequires(ctx.editor);\n        }\n    };\n};\n\n/**\n * @param {import(\"../contextInit\").ItemMenuContext} ctx\n * @returns {UserDefinedItem}\n */\nconst imageEffectsNestedMenu = (ctx) => {\n    return {\n        name: 'imageEffects',\n        widgetKey: 'imatge',\n        title: 'Efectes d\\'imatge',\n        subMenuItems: () => {\n            const elem = ctx.path?.elem;\n            if (!elem) {\n                return '';\n            }\n            if (!elem.attr('data-snptd')) {\n                return prefixPluginName(\"addZoomEffect addLightboxEffect\");\n            } else {\n                return prefixPluginName(\"removeImageEffects\");\n            }\n        }\n    };\n};\n\nregisterMenuItem((ctx) => addImageEffectItem(ctx, 'zoom'));\nregisterMenuItem((ctx) => addImageEffectItem(ctx, 'lightbox'));\nregisterMenuItem(removeImageEffectsItem);\nregisterMenuItem(imageEffectsNestedMenu);\n"],"names":["prefixPluginName","str","split","map","e","trim","join","addImageEffectItem","ctx","type","name","title","action","elem","path","_ctx$path","attr","editor","icon","_ctx$path2","removeAttr","widgetKey","subMenuItems","_ctx$path3"],"mappings":"gIASSA,iBAAiBC,YACfA,IAAIC,MAAM,OAAOC,KAAIC,GAEd,OADVA,EAAIA,EAAEC,QAEKD,EAEJ,aAAeA,IACvBE,KAAK,WAYNC,mBAAqB,CAACC,IAAKC,QACtB,CACHC,KAAO,MAAKD,aACZE,MAAQ,iBAAgBF,OACxBG,OAAQ,yBACEC,uBAAOL,IAAIM,iCAAJC,UAAUF,KAClBA,OAGLA,KAAKG,KAAK,aAAcP,oCACZD,IAAIS,OAAQ,CAAC,2DAgDnBT,KAAQD,mBAAmBC,IAAK,2CAChCA,KAAQD,mBAAmBC,IAAK,+CAxClBA,MACrB,CACHE,KAAM,qBACNC,MAAO,4BACPO,KAAM,QACNN,OAAQ,0BACEC,wBAAOL,IAAIM,kCAAJK,WAAUN,KAClBA,OAGLA,KAAKO,WAAW,oDACIZ,IAAIS,+CASJT,MACrB,CACHE,KAAM,eACNW,UAAW,SACXV,MAAO,mBACPW,aAAc,0BACJT,wBAAOL,IAAIM,kCAAJS,WAAUV,YAClBA,KAGAA,KAAKG,KAAK,cAGJhB,iBAAiB,sBAFjBA,iBAAiB,mCAHjB"}