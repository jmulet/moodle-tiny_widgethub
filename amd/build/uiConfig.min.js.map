{"version":3,"file":"uiConfig.min.js","sources":["../src/uiConfig.js"],"sourcesContent":["/* eslint-disable no-eq-null */\n/* eslint-disable no-console */\n// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\nimport {IBConfigModal} from \"./modal\";\nimport ModalEvents from 'core/modal_events';\nimport ModalFactory from 'core/modal_factory';\nimport {UserStorage} from \"./util\";\nimport {getCourseId, getUserId} from \"./options\";\n\n/**\n * Tiny WidgetHub plugin.\n *\n * @module      tiny_widgethub/plugin\n * @copyright   2024 Josep Mulet Pol <pmulet@iedib.net>\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nexport class UiConfigCtrl {\n    uiPickController;\n    editor;\n    modal;\n\n    constructor(uiPickController) {\n        this.uiPickController = uiPickController;\n        this.editor = this.uiPickController.editor;\n        this.userStorage = UserStorage.getInstance(getUserId(this.editor), getCourseId(this.editor));\n    }\n\n    async handleAction() {\n        const data = {\n            checked1: this.userStorage.getFromLocal('saveall', false) ? ' checked' : '',\n            checked2: this.userStorage.getFromLocal('start.latexf', false) ? ' checked' : '',\n            checked3: this.userStorage.getFromLocal('start.disablespanf', false) ? ' checked' : ''\n        };\n        this.modal = await ModalFactory.create({\n                type: IBConfigModal.TYPE,\n                templateContext: data,\n                large: true,\n        });\n        this.modal.footer.find(\"button.btn-primary\").on(\"click\", () => {\n            this.applyChanges();\n            this.modal.destroy();\n            this.uiPickController.show();\n        });\n        this.modal.footer.find(\"button.btn-secondary\").on(\"click\", () => {\n            this.modal.destroy();\n            this.uiPickController.show();\n        });\n        this.modal.getRoot().on(ModalEvents.hidden, () => {\n            this.modal.destroy();\n            this.uiPickController.show();\n        });\n\n        this.modal.show();\n    }\n\n    applyChanges() {\n        const checked1 = this.modal.body.find(\"#snpt-ckbx-saveall\").is(':checked');\n        this.userStorage.setToLocal('saveall', checked1, false);\n        const checked2 = this.modal.body.find(\"#snpt-ckbx-startlatexf\").is(':checked');\n        this.userStorage.setToLocal('start.latexf', checked2, false);\n        const checked3 = this.modal.body.find(\"#snpt-ckbx-startspanf\").is(':checked');\n        this.userStorage.setToLocal('start.disablespanf', checked3, true);\n    }\n}"],"names":["constructor","uiPickController","editor","this","userStorage","UserStorage","getInstance","data","checked1","getFromLocal","checked2","checked3","modal","ModalFactory","create","type","IBConfigModal","TYPE","templateContext","large","footer","find","on","applyChanges","destroy","show","getRoot","ModalEvents","hidden","body","is","setToLocal"],"mappings":";;;;;;;gOAoCIA,YAAYC,kJACHA,iBAAmBA,sBACnBC,OAASC,KAAKF,iBAAiBC,YAC/BE,YAAcC,kBAAYC,aAAY,sBAAUH,KAAKD,SAAS,wBAAYC,KAAKD,oCAI9EK,KAAO,CACTC,SAAUL,KAAKC,YAAYK,aAAa,WAAW,GAAS,WAAa,GACzEC,SAAUP,KAAKC,YAAYK,aAAa,gBAAgB,GAAS,WAAa,GAC9EE,SAAUR,KAAKC,YAAYK,aAAa,sBAAsB,GAAS,WAAa,SAEnFG,YAAcC,uBAAaC,OAAO,CAC/BC,KAAMC,qBAAcC,KACpBC,gBAAiBX,KACjBY,OAAO,SAEVP,MAAMQ,OAAOC,KAAK,sBAAsBC,GAAG,SAAS,UAChDC,oBACAX,MAAMY,eACNvB,iBAAiBwB,eAErBb,MAAMQ,OAAOC,KAAK,wBAAwBC,GAAG,SAAS,UAClDV,MAAMY,eACNvB,iBAAiBwB,eAErBb,MAAMc,UAAUJ,GAAGK,sBAAYC,QAAQ,UACnChB,MAAMY,eACNvB,iBAAiBwB,eAGrBb,MAAMa,OAGfF,qBACUf,SAAWL,KAAKS,MAAMiB,KAAKR,KAAK,sBAAsBS,GAAG,iBAC1D1B,YAAY2B,WAAW,UAAWvB,UAAU,SAC3CE,SAAWP,KAAKS,MAAMiB,KAAKR,KAAK,0BAA0BS,GAAG,iBAC9D1B,YAAY2B,WAAW,eAAgBrB,UAAU,SAChDC,SAAWR,KAAKS,MAAMiB,KAAKR,KAAK,yBAAyBS,GAAG,iBAC7D1B,YAAY2B,WAAW,qBAAsBpB,UAAU"}