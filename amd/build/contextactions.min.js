define("tiny_widgethub/contextactions",["exports","./options","./service/dom_service","./controller/widgetproperties_ctrl","./extension","core/str","./common"],(function(_exports,_options,_dom_service,_widgetproperties_ctrl,_extension,_str,_common){var obj;Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.ContextActionsManager=void 0,_exports.getContextMenuManager=function(editor){let instance=contextMenuManagerInstances.get(editor);instance||(instance=new ContextActionsManager(editor,(0,_dom_service.getDomSrv)(),{get_strings:_str.get_strings}),contextMenuManagerInstances.set(editor,instance));return instance},_common=(obj=_common)&&obj.__esModule?obj:{default:obj};const{component:component,componentName:componentName}=_common.default,ICONS_gear="gear",ICONS_arrowUpFromBracket="arrow-up-from-bracket",ICONS_arrowUp="arrow-up",ICONS_arrowDown="arrow-down",ICONS_arrowLeft="arrow-left",ICONS_arrowRight="arrow-right",ICONS_remove="remove",ICONS_clone="clone",ICONS_cut="cut",ICONS_paste="paste";
/**
   * Tiny WidgetHub plugin.
   *
   * @module      tiny_widgethub/plugin
   * @copyright   2024 Josep Mulet Pol <pep.mulet@gmail.com>
   * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   */function hasBindings(widget){var _widget$parameters;return null===(_widget$parameters=widget.parameters)||void 0===_widget$parameters?void 0:_widget$parameters.some((param=>{if("repeatable"===param.type){var _param$fields;const hasFieldBindings=null===(_param$fields=param.fields)||void 0===_param$fields?void 0:_param$fields.some((f=>void 0!==f.bind));return"object"==typeof param.bind||hasFieldBindings&&"string"==typeof param.item_selector}return void 0!==param.bind}))}const prefixMenuItems=menuItems=>menuItems.map((e=>"|"===e?"|":`${componentName}_${e}`));class ContextActionsManager{i18n;ctx;widgetCutClipboard;widgetList;constructor(editor,domSrv,translateSrv){this.editor=editor,this.domSrv=domSrv,this.translateSrv=translateSrv,this.ctx={actionPaths:{},editor:editor},this.widgetCutClipboard={widget:void 0,html:void 0},this.widgetList=Object.values((0,_options.getWidgetDict)(editor)),this.i18n=Object.create(null)}async init(){var editor;this.i18n=await this.loadStrings(),this.predefinedActions=function(editor,domSrv,widgetCutClipboard){const factory={unwrap:path=>{var _path$widget;if(null==path||!path.elem||null==path||null===(_path$widget=path.widget)||void 0===_path$widget||!_path$widget.unwrap)return;const nodes=path.elem.querySelectorAll(path.widget.unwrap);if(path.elem.parentNode){if(0===nodes.length){const textNode=document.createTextNode(path.elem.textContent);path.elem.replaceWith(textNode)}else if(1===nodes.length)path.elem.replaceWith(nodes[0]);else{const fragment=document.createDocumentFragment();nodes.forEach((node=>fragment.appendChild(node))),path.elem.replaceWith(fragment)}(0,_extension.getListeners)("widgetRemoved").forEach((listener=>listener(editor,path.widget)))}},movebefore:path=>{const el=null==path?void 0:path.targetElement,root=null==path?void 0:path.elem;if(!el||!root)return;const prev=el.previousElementSibling;var _el$parentNode;prev&&(null===(_el$parentNode=el.parentNode)||void 0===_el$parentNode||_el$parentNode.insertBefore(el,prev),prev.closest(".nav")&&domSrv.findReferences(el,root).forEach((ref=>{const prev2=ref.previousElementSibling;var _ref$parentNode;prev2&&(null===(_ref$parentNode=ref.parentNode)||void 0===_ref$parentNode||_ref$parentNode.insertBefore(ref,prev2))})))},moveafter:path=>{const el=null==path?void 0:path.targetElement,root=null==path?void 0:path.elem;if(!el||!root)return;const next=el.nextElementSibling;var _next$parentNode;next&&(null===(_next$parentNode=next.parentNode)||void 0===_next$parentNode||_next$parentNode.insertBefore(next,el),next.closest(".nav")&&domSrv.findReferences(el,root).forEach((ref=>{const next2=ref.nextElementSibling;var _next2$parentNode;next2&&(null===(_next2$parentNode=next2.parentNode)||void 0===_next2$parentNode||_next2$parentNode.insertBefore(next2,ref))})))},insertafter:path=>{var _el$parentNode2;const el=null==path?void 0:path.targetElement,root=null==path?void 0:path.elem;if(!el||!root)return;const clone=domSrv.smartClone(el,root,{});null===(_el$parentNode2=el.parentNode)||void 0===_el$parentNode2||_el$parentNode2.insertBefore(clone,el.nextSibling),clone.classList.remove("active","show")},remove:path=>{const el=null==path?void 0:path.targetElement,root=null==path?void 0:path.elem,widget=null==path?void 0:path.widget;if(!el||!root||!widget)return;if(el===root)return root.remove(),void(0,_extension.getListeners)("widgetRemoved").forEach((listener=>listener(editor,widget)));domSrv.findReferences(el,root).forEach((ref=>ref.remove()));const parent=el.parentNode;null==el||el.remove(),parent&&0===parent.children.length&&(root.remove(),(0,_extension.getListeners)("widgetRemoved").forEach((listener=>listener(editor,widget))))},printable:path=>{const el=null==path?void 0:path.elem;el&&el.classList.toggle("d-print-none")},cut:path=>{const el=null==path?void 0:path.elem;el&&null!=path&&path.widget&&(widgetCutClipboard.widget=path.widget,widgetCutClipboard.html=el.outerHTML,el.remove(),editor.nodeChanged(),editor.undoManager.add(),(0,_extension.getListeners)("widgetRemoved").forEach((listener=>listener(editor,path.widget))))}};return factory.moveup=factory.movebefore,factory.movedown=factory.moveafter,factory.moveleft=factory.movebefore,factory.moveright=factory.moveafter,factory.insert=factory.insertafter,factory}(this.editor,this.domSrv,this.widgetCutClipboard),(editor=this.editor).ui.registry.addIcon(ICONS_gear,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 512 512"><path d="M495.9 166.6c3.2 8.7 .5 18.4-6.4 24.6l-43.3 39.4c1.1 8.3 1.7 16.8 1.7 25.4s-.6 17.1-1.7 25.4l43.3 39.4c6.9 6.2 9.6 15.9 6.4 24.6c-4.4 11.9-9.7 23.3-15.8 34.3l-4.7 8.1c-6.6 11-14 21.4-22.1 31.2c-5.9 7.2-15.7 9.6-24.5 6.8l-55.7-17.7c-13.4 10.3-28.2 18.9-44 25.4l-12.5 57.1c-2 9.1-9 16.3-18.2 17.8c-13.8 2.3-28 3.5-42.5 3.5s-28.7-1.2-42.5-3.5c-9.2-1.5-16.2-8.7-18.2-17.8l-12.5-57.1c-15.8-6.5-30.6-15.1-44-25.4L83.1 425.9c-8.8 2.8-18.6 .3-24.5-6.8c-8.1-9.8-15.5-20.2-22.1-31.2l-4.7-8.1c-6.1-11-11.4-22.4-15.8-34.3c-3.2-8.7-.5-18.4 6.4-24.6l43.3-39.4C64.6 273.1 64 264.6 64 256s.6-17.1 1.7-25.4L22.4 191.2c-6.9-6.2-9.6-15.9-6.4-24.6c4.4-11.9 9.7-23.3 15.8-34.3l4.7-8.1c6.6-11 14-21.4 22.1-31.2c5.9-7.2 15.7-9.6 24.5-6.8l55.7 17.7c13.4-10.3 28.2-18.9 44-25.4l12.5-57.1c2-9.1 9-16.3 18.2-17.8C227.3 1.2 241.5 0 256 0s28.7 1.2 42.5 3.5c9.2 1.5 16.2 8.7 18.2 17.8l12.5 57.1c15.8 6.5 30.6 15.1 44 25.4l55.7-17.7c8.8-2.8 18.6-.3 24.5 6.8c8.1 9.8 15.5 20.2 22.1 31.2l4.7 8.1c6.1 11 11.4 22.4 15.8 34.3zM256 336a80 80 0 1 0 0-160 80 80 0 1 0 0 160z"/></svg>'),editor.ui.registry.addIcon(ICONS_arrowUpFromBracket,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 448 512"><path d="M246.6 9.4c-12.5-12.5-32.8-12.5-45.3 0l-128 128c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L192 109.3 192 320c0 17.7 14.3 32 32 32s32-14.3 32-32l0-210.7 73.4 73.4c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-128-128zM64 352c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64c0 53 43 96 96 96l256 0c53 0 96-43 96-96l0-64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 64c0 17.7-14.3 32-32 32L96 448c-17.7 0-32-14.3-32-32l0-64z"/></svg>'),editor.ui.registry.addIcon(ICONS_arrowUp,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 384 512"><path d="M214.6 41.4c-12.5-12.5-32.8-12.5-45.3 0l-160 160c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0L160 141.2 160 448c0 17.7 14.3 32 32 32s32-14.3 32-32l0-306.7L329.4 246.6c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3l-160-160z"/></svg>'),editor.ui.registry.addIcon(ICONS_arrowDown,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 384 512"><path d="M169.4 470.6c12.5 12.5 32.8 12.5 45.3 0l160-160c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0L224 370.8 224 64c0-17.7-14.3-32-32-32s-32 14.3-32 32l0 306.7L54.6 265.4c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3l160 160z"/></svg>'),editor.ui.registry.addIcon(ICONS_arrowLeft,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 448 512"><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.2 288 416 288c17.7 0 32-14.3 32-32s-14.3-32-32-32l-306.7 0L214.6 118.6c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"/></svg>'),editor.ui.registry.addIcon(ICONS_arrowRight,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 448 512"><path d="M438.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-160-160c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L338.8 224 32 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l306.7 0L233.4 393.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l160-160z"/></svg>'),editor.ui.registry.addIcon(ICONS_clone,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 512 512"><path d="M64 464l224 0c8.8 0 16-7.2 16-16l0-64 48 0 0 64c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64L0 224c0-35.3 28.7-64 64-64l64 0 0 48-64 0c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16zM224 304l224 0c8.8 0 16-7.2 16-16l0-224c0-8.8-7.2-16-16-16L224 48c-8.8 0-16 7.2-16 16l0 224c0 8.8 7.2 16 16 16zm-64-16l0-224c0-35.3 28.7-64 64-64L448 0c35.3 0 64 28.7 64 64l0 224c0 35.3-28.7 64-64 64l-224 0c-35.3 0-64-28.7-64-64z"/></svg>'),editor.ui.registry.addIcon(ICONS_cut,'<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 640 640"><path d="M256 320L216.5 359.5C203.9 354.6 190.3 352 176 352C114.1 352 64 402.1 64 464C64 525.9 114.1 576 176 576C237.9 576 288 525.9 288 464C288 449.7 285.3 436.1 280.5 423.5L563.2 140.8C570.3 133.7 570.3 122.3 563.2 115.2C534.9 86.9 489.1 86.9 460.8 115.2L320 256L280.5 216.5C285.4 203.9 288 190.3 288 176C288 114.1 237.9 64 176 64C114.1 64 64 114.1 64 176C64 237.9 114.1 288 176 288C190.3 288 203.9 285.3 216.5 280.5L256 320zM353.9 417.9L460.8 524.8C489.1 553.1 534.9 553.1 563.2 524.8C570.3 517.7 570.3 506.3 563.2 499.2L417.9 353.9L353.9 417.9zM128 176C128 149.5 149.5 128 176 128C202.5 128 224 149.5 224 176C224 202.5 202.5 224 176 224C149.5 224 128 202.5 128 176zM176 416C202.5 416 224 437.5 224 464C224 490.5 202.5 512 176 512C149.5 512 128 490.5 128 464C128 437.5 149.5 416 176 416z"/></svg>'),editor.ui.registry.addIcon(ICONS_paste,'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 640"><path d="M128 64C92.7 64 64 92.7 64 128L64 448C64 483.3 92.7 512 128 512L240 512L240 288C240 226.1 290.1 176 352 176L416 176L416 128C416 92.7 387.3 64 352 64L128 64zM312 176L168 176C154.7 176 144 165.3 144 152C144 138.7 154.7 128 168 128L312 128C325.3 128 336 138.7 336 152C336 165.3 325.3 176 312 176zM352 224C316.7 224 288 252.7 288 288L288 512C288 547.3 316.7 576 352 576L512 576C547.3 576 576 547.3 576 512L576 346.5C576 329.5 569.3 313.2 557.3 301.2L498.8 242.7C486.8 230.7 470.5 224 453.5 224L352 224z"/></svg>'),this.registerUI(),await this.registerExtensionMenus(),this.registerContextMenus(),this.registerContextToolbars()}async loadStrings(){const keys=["properties","unwrap","moveup","movedown","moveafter","movebefore","insert","remove","printable","cut","paste"],values=await this.translateSrv.get_strings(keys.map((key=>({key:key,component:component}))));return Object.fromEntries(keys.map(((k,i)=>[k,values[i]])))}showPropertiesAction=async()=>{const path=this.domSrv.findWidgetOnEventPath(this.widgetList,this.editor.selection.getNode());if(this.ctx.path=path,!path.widget)return;const widgetPropertiesCtrl=(0,_widgetproperties_ctrl.getWidgetPropertiesCtrl)(this.editor);await widgetPropertiesCtrl.show(path)};pasteAction(){var _this$widgetCutClipbo,_this$widgetCutClipbo2;const html=null===(_this$widgetCutClipbo=this.widgetCutClipboard)||void 0===_this$widgetCutClipbo?void 0:_this$widgetCutClipbo.html,widget=null===(_this$widgetCutClipbo2=this.widgetCutClipboard)||void 0===_this$widgetCutClipbo2?void 0:_this$widgetCutClipbo2.widget;html&&widget&&(this.editor.insertContent(html),this.editor.undoManager.add(),this.editor.nodeChanged(),(0,_extension.getListeners)("widgetInserted").forEach((listener=>listener(this.editor,widget))),this.widgetCutClipboard.widget=void 0,this.widgetCutClipboard.html=void 0)}registerUIElement(spec){this.editor.ui.registry.addButton(`${componentName}_${spec.name}_btn`,{icon:spec.icon,tooltip:spec.tooltip,onAction:spec.onAction}),this.editor.ui.registry.addMenuItem(`${componentName}_${spec.name}_item`,{icon:spec.icon,tooltip:spec.tooltip,onAction:spec.onAction}),this.editor.ui.registry.addNestedMenuItem(`${componentName}_${spec.name}_nesteditem`,{icon:spec.icon,tooltip:spec.tooltip,getSubmenuItems:()=>{var _this$ctx$actionPaths;const items=[];return null===(_this$ctx$actionPaths=this.ctx.actionPaths[spec.name])||void 0===_this$ctx$actionPaths||_this$ctx$actionPaths.forEach((path=>{var _path$widget2;items.push({type:"menuitem",text:path.text,tooltip:spec.name+"/"+((null===(_path$widget2=path.widget)||void 0===_path$widget2?void 0:_path$widget2.name)??""),onAction:()=>spec.onAction(path)})})),items}})}genericAction(name){return path=>{var _path,_this$predefinedActio,_path2;if((null===(_path=path=path??this.ctx.path)||void 0===_path||!_path.widget)&&(null===(_path2=path=this.domSrv.findWidgetOnEventPath(this.widgetList,this.editor.selection.getNode()))||void 0===_path2||!_path2.widget))return;const action=null===(_this$predefinedActio=this.predefinedActions)||void 0===_this$predefinedActio?void 0:_this$predefinedActio[name];action&&(action(path),(0,_extension.getListeners)("ctxAction").forEach((listener=>{var _path3;return listener(this.editor,null===(_path3=path)||void 0===_path3?void 0:_path3.widget)})))}}registerUI(){this.registerUIElement({name:"modal",icon:ICONS_gear,tooltip:this.i18n.properties,onAction:this.showPropertiesAction}),this.editor.ui.registry.addMenuItem(`${componentName}_paste_item`,{icon:ICONS_paste,text:this.i18n.paste,onAction:this.pasteAction}),this.registerUIElement({name:"unwrap",icon:ICONS_arrowUpFromBracket,tooltip:this.i18n.unwrap,onAction:this.genericAction("unwrap")}),this.registerUIElement({name:"moveup",icon:ICONS_arrowUp,tooltip:this.i18n.moveup,onAction:this.genericAction("movebefore")}),this.registerUIElement({name:"movedown",icon:ICONS_arrowDown,tooltip:this.i18n.movedown,onAction:this.genericAction("moveafter")}),this.registerUIElement({name:"movebefore",icon:ICONS_arrowLeft,tooltip:this.i18n.movebefore,onAction:this.genericAction("movebefore")}),this.registerUIElement({name:"moveafter",icon:ICONS_arrowRight,tooltip:this.i18n.moveafter,onAction:this.genericAction("moveafter")}),this.registerUIElement({name:"insertafter",icon:ICONS_clone,tooltip:this.i18n.insert,onAction:this.genericAction("insertafter")}),this.registerUIElement({name:"remove",icon:ICONS_remove,tooltip:this.i18n.remove,onAction:this.genericAction("remove")}),this.registerUIElement({name:"cut",icon:ICONS_cut,tooltip:this.i18n.cut,onAction:this.genericAction("cut")}),this.editor.ui.registry.addToggleMenuItem(`${componentName}_printable_item`,{icon:"print",text:this.i18n.printable,onAction:this.genericAction("printable"),onSetup:api=>{var _this$ctx$path,_this$ctx$path$elem,_this$ctx$path$elem$c;let toggleState=!0;return null!==(_this$ctx$path=this.ctx.path)&&void 0!==_this$ctx$path&&null!==(_this$ctx$path$elem=_this$ctx$path.elem)&&void 0!==_this$ctx$path$elem&&null!==(_this$ctx$path$elem$c=_this$ctx$path$elem.classList)&&void 0!==_this$ctx$path$elem$c&&_this$ctx$path$elem$c.contains("d-print-none")&&(toggleState=!1),api.setActive(toggleState),()=>({})}})}async registerExtensionMenus(){this.widgetsWithExtensions=(await Promise.all((0,_extension.getMenuItemProviders)().map((provider=>provider(this.ctx))))).flat(),this.widgetsWithExtensions.forEach((menuItem=>{menuItem.subMenuItems?this.editor.ui.registry.addNestedMenuItem(`${componentName}_${menuItem.name}`,{icon:menuItem.icon,text:menuItem.title,getSubmenuItems:menuItem.subMenuItems}):menuItem.onAction&&this.editor.ui.registry.addMenuItem(`${componentName}_${menuItem.name}`,{icon:menuItem.icon,text:menuItem.title,onAction:menuItem.onAction})}))}populateMenuItems(element,path){const menuItems=[];if(!path.widget)return menuItems;hasBindings(path.widget)&&this.ctx.actionPaths.modal.push({...path}),path.widget.unwrap&&(menuItems.push("unwrap"),this.ctx.actionPaths.unwrap=this.ctx.actionPaths.unwrap||[],this.ctx.actionPaths.unwrap.push({...path}));let contextmenu=path.widget.prop("contextmenu");return contextmenu?(Array.isArray(contextmenu)||(contextmenu=[contextmenu]),contextmenu.forEach((cm=>{let targetElem=null;if(targetElem=cm.predicate?element.matches(cm.predicate)?element:element.closest(cm.predicate):(null==path?void 0:path.elem)??null,!targetElem)return;const newActionsToAdd=cm.actions.split(/\s+/).filter(Boolean).map((action=>"moveleft"===(action=action.trim().toLowerCase())?"movebefore":"moveright"===action?"moveafter":"insert"===action?"insertafter":action)).filter((action=>"|"===action||!menuItems.includes(action)));menuItems.push(...newActionsToAdd),newActionsToAdd.filter((e=>"|"!==e)).forEach((e=>{path.targetElement=targetElem,this.ctx.actionPaths[e]=this.ctx.actionPaths[e]||[],this.ctx.actionPaths[e].push({...path,text:cm.description})}))})),menuItems):menuItems}contextMenuUpdate(element){var _this$widgetsWithExte;let menuItems=[];this.widgetCutClipboard.widget&&menuItems.push("paste_item"),this.ctx.path=this.domSrv.findWidgetOnEventPath(this.widgetList,element),this.ctx.actionPaths={modal:[]};const widget=this.ctx.path.widget;if(!widget)return prefixMenuItems(menuItems);let parentPath=null;if(widget.prop("bubbles")){var _this$ctx$path2,_this$ctx$path2$elem;const parentElem=null===(_this$ctx$path2=this.ctx.path)||void 0===_this$ctx$path2||null===(_this$ctx$path2$elem=_this$ctx$path2.elem)||void 0===_this$ctx$path2$elem?void 0:_this$ctx$path2$elem.parentElement;if(parentElem){var _p$widget;const p=this.domSrv.findWidgetOnEventPath(this.widgetList,parentElem);p&&(null===(_p$widget=p.widget)||void 0===_p$widget?void 0:_p$widget.key)===widget.prop("bubbles")&&(parentPath={...p})}}parentPath&&menuItems.push(...this.populateMenuItems(element,parentPath)),menuItems.push(...this.populateMenuItems(element,this.ctx.path)),menuItems=menuItems.map((e=>{var _this$ctx$actionPaths2;return"|"===e?e:["cut","paste"].includes(e)?`${e}_item`:(null===(_this$ctx$actionPaths2=this.ctx.actionPaths[e])||void 0===_this$ctx$actionPaths2?void 0:_this$ctx$actionPaths2.length)>1?`${e}_nesteditem`:`${e}_item`}));const actionNames=(null===(_this$widgetsWithExte=this.widgetsWithExtensions)||void 0===_this$widgetsWithExte?void 0:_this$widgetsWithExte.filter((e=>{return condition=e.condition,value=widget.key,"string"==typeof condition?condition.split(",").map((e=>e.trim())).includes(value):condition instanceof RegExp?condition.test(value):"function"==typeof condition&&condition();var condition,value})).map((e=>e.name)))??[];return menuItems.push(...actionNames),prefixMenuItems(menuItems)}registerContextMenus(){this.editor.ui.registry.addContextMenu(`${componentName}_cm`,{update:element=>this.contextMenuUpdate(element).join(" ")})}registerContextToolbars(){this.widgetList.filter((widget=>widget.prop("contexttoolbar")&&!widget.isFilter())).forEach((widget=>{const items=[];hasBindings(widget)&&items.push("modal");widget.prop("contexttoolbar").filter((ctbSpec=>!ctbSpec.predicate)).forEach((ctbSpec=>{const actionsToAdd=ctbSpec.actions.toLowerCase().split(/\s+/).filter(Boolean).map((e=>e.trim())).filter((e=>["|","cut","printable"].includes(e)));items.push(actionsToAdd)})),widget.unwrap&&items.push("unwrap"),this.editor.ui.registry.addContextToolbar(`${componentName}_ctb_${widget.key}`,{predicate:function(node){var _path$widget3;return(null===(_path$widget3=this.domSrv.findWidgetOnEventPath(this.widgetList,node).widget)||void 0===_path$widget3?void 0:_path$widget3.key)===widget.key},items:items.map((e=>"|"===e?"|":`${componentName}_${e}_btn`)).join(" "),position:"node",scope:"node"})}))}}_exports.ContextActionsManager=ContextActionsManager;const contextMenuManagerInstances=new Map}));

//# sourceMappingURL=contextactions.min.js.map